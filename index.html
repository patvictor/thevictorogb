import React, { useEffect, useRef, useState } from 'react';
import { motion, useAnimation } from 'framer-motion';
import { Button } from '@/components/ui/button';
import { FaArrowRight } from 'react-icons/fa6';
import Image from 'next/image';

const fadeIn = (delay = 0) => ({
  hidden: { opacity: 0, y: 50 },
  visible: {
    opacity: 1,
    y: 0,
    transition: {
      duration: 0.8,
      delay,
    },
  },
});

const HomeHero = () => {
  const controls = useAnimation();
  const [aboutVisible, setAboutVisible] = useState(false);
  const hireRef = useRef(null);
  const portfolioRef = useRef(null);

  const handleScroll = () => {
    const about = document.getElementById('about');
    if (about) {
      const rect = about.getBoundingClientRect();
      const isVisible = rect.top < window.innerHeight && rect.bottom >= 0;
      setAboutVisible(isVisible);
    }
  };

  useEffect(() => {
    window.addEventListener('scroll', handleScroll);
    return () => window.removeEventListener('scroll', handleScroll);
  }, []);

  useEffect(() => {
    controls.start('visible');
  }, [controls]);

  useEffect(() => {
    let interval;
    let delay = 0;
    const animateReflection = () => {
      const hire = hireRef.current;
      const portfolio = portfolioRef.current;
      if (hire && portfolio) {
        hire.classList.add('shine');
        setTimeout(() => {
          hire.classList.remove('shine');
          portfolio.classList.add('shine');
          setTimeout(() => {
            portfolio.classList.remove('shine');
          }, 2000);
        }, 2000);
      }
    };
    interval = setInterval(animateReflection, 5000);
    return () => clearInterval(interval);
  }, []);

  return (
    <div className="min-h-screen w-full bg-black text-white overflow-x-hidden">
      <motion.div
        initial="hidden"
        animate={controls}
        variants={fadeIn(0)}
        className="p-8 pt-28 text-center"
      >
        <motion.h1
          className="text-4xl font-bold mb-4"
          variants={fadeIn(1)}
        >
          Hi, Iâ€™m Victor Ogbeide
        </motion.h1>

        <motion.p
          className="text-lg max-w-xl mx-auto mb-6"
          variants={fadeIn(2)}
        >
          I design professional and timely graphics for businesses, events and brands. I love to use clean layout and visual harmony to communicate ideas.
        </motion.p>

        <motion.div
          className="flex justify-center items-center gap-4"
          variants={fadeIn(3)}
        >
          <motion.a
            ref={hireRef}
            href="https://wa.me/message/7U4T2N47JMNOL1"
            className="relative rounded-2xl px-6 py-3 text-white bg-gradient-to-r from-slate-200 via-white to-slate-200 bg-[length:200%_100%] overflow-hidden"
            style={{ backgroundClip: 'text', WebkitBackgroundClip: 'text', color: 'transparent' }}
          >
            <span className="shine-effect">Hire Me</span>
          </motion.a>

          <motion.a
            ref={portfolioRef}
            href="https://x.com/dvictorogbeide?t=a2h4Yq48_okO2_Et9lrFgA&s=09"
            className="relative rounded-2xl px-6 py-3 text-white bg-gradient-to-r from-slate-200 via-white to-slate-200 bg-[length:200%_100%] overflow-hidden"
            style={{ backgroundClip: 'text', WebkitBackgroundClip: 'text', color: 'transparent' }}
          >
            <span className="shine-effect">Portfolio</span>
          </motion.a>
        </motion.div>

        <motion.div className="mt-10" variants={fadeIn(4)}>
          <Image
            src="https://raw.githubusercontent.com/patvictor/thevictorogbeide/refs/heads/Images/my%20pic.jpg"
            alt="Victor Ogbeide"
            width={180}
            height={180}
            className="rounded-full mx-auto border-4 border-white motion-safe:animate-fadeIn"
          />
        </motion.div>
      </motion.div>

      <motion.div
        id="about"
        initial={{ opacity: 0.2 }}
        animate={{ opacity: aboutVisible ? 1 : 0.2 }}
        transition={{ duration: 1 }}
        className="p-8 text-center"
      >
        <h2 className="text-2xl font-semibold mb-2">About Me</h2>
        <p className="text-md max-w-2xl mx-auto">
          I'm passionate about helping people and businesses look good and stay memorable with good visual presentation.
        </p>
      </motion.div>

      <style jsx>{`
        .shine {
          background: linear-gradient(120deg, transparent, rgba(255,255,255,0.8), transparent);
          background-size: 200% 100%;
          background-position: -100% center;
          animation: shineEffect 2s ease forwards;
        }

        .shine-effect {
          position: relative;
          display: inline-block;
        }

        @keyframes shineEffect {
          0% { background-position: -100% center; }
          100% { background-position: 200% center; }
        }

        @keyframes fadeInImage {
          from { opacity: 0; transform: scale(0.8); }
          to { opacity: 1; transform: scale(1); }
        }

        .animate-fadeIn {
          animation: fadeInImage 1s ease-in-out forwards;
        }
      `}</style>
    </div>
  );
};

export default HomeHero;
